dslab_lcy@chenh2-tyna:/Group16T/common/lcy/dslab_lcy/GitRepo/scLightGAT$ python test.py
2025-07-22 16:26:07 - INFO - scLightGAT.pipeline - [TRAIN MODE] Starting training pipeline
2025-07-22 16:26:07 - INFO - scLightGAT.pipeline - Train data: ./data/train.h5ad
2025-07-22 16:26:07 - INFO - scLightGAT.pipeline - Test data: ./data/pbmc68k.h5ad
2025-07-22 16:26:07 - INFO - scLightGAT.pipeline - Output dir: /Group16T/common/lcy/dslab_lcy/GitRepo/scLightGAT/results
2025-07-22 16:26:07 - INFO - scLightGAT.pipeline - Model save dir: /Group16T/common/lcy/dslab_lcy/GitRepo/scLightGAT/models
2025-07-22 16:26:07 - INFO - scLightGAT.pipeline - Train DVAE: True, Use GAT: True, DVAE Epochs: 5, GAT Epochs: 300
2025-07-22 16:26:07 - INFO - scLightGAT.pipeline - Hierarchical mode: False
2025-07-22 16:26:29 - INFO - scLightGAT.training.model_manager - CellTypeAnnotator initialized on device: cuda
2025-07-22 16:26:29 - INFO - scLightGAT.training.model_manager - DVAE enabled: True, HVG enabled: True
2025-07-22 16:26:29 - INFO - scLightGAT.training.model_manager - Hierarchical classification: False
2025-07-22 16:26:29 - INFO - scLightGAT.training.model_manager - Starting complete annotation pipeline
2025-07-22 16:26:29 - INFO - scLightGAT.training.model_manager - Starting feature extraction
2025-07-22 16:26:29 - INFO - scLightGAT.preprocess.prediction_preprocess - üíæPreparing data for all models
2025-07-22 16:26:33 - INFO - scLightGAT.preprocess.prediction_preprocess - ‚è∞Preparing DGEs data
2025-07-22 16:26:33 - INFO - scLightGAT.preprocess.prediction_preprocess - Performing feature selection using Celltype_training
2025-07-22 16:26:56 - INFO - scLightGAT.preprocess.prediction_preprocess - Generating feature list with top 3000 features
2025-07-22 16:26:56 - INFO - scLightGAT.preprocess.prediction_preprocess - üß¨Number of common DGEs: 862üß¨
2025-07-22 16:27:00 - INFO - scLightGAT.preprocess.prediction_preprocess - Final shape of adata_train_dge: (158681, 862)
2025-07-22 16:27:00 - INFO - scLightGAT.preprocess.prediction_preprocess - Final shape of adata_test_dge: (68579, 862)
2025-07-22 16:27:00 - INFO - scLightGAT.preprocess.prediction_preprocess - ‚è∞Preparing HVG data
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/scanpy/preprocessing/_highly_variable_genes.py:72: User
Warning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
2025-07-22 16:27:11 - INFO - scLightGAT.preprocess.prediction_preprocess - üß¨Number of common HVGs: 3000üß¨
2025-07-22 16:27:17 - INFO - scLightGAT.preprocess.prediction_preprocess - Final shape of adata_train_hvg: (158681, 3000)
2025-07-22 16:27:17 - INFO - scLightGAT.preprocess.prediction_preprocess - Final shape of adata_test_hvg: (68579, 3000)
2025-07-22 16:27:17 - INFO - scLightGAT.preprocess.prediction_preprocess - üíæPreparing data for LightGBM
2025-07-22 16:27:17 - INFO - scLightGAT.preprocess.prediction_preprocess - Transforming AnnData object for Celltype_training
2025-07-22 16:27:17 - INFO - scLightGAT.preprocess.prediction_preprocess - üíæPreparing data for DVAE
2025-07-22 16:27:17 - INFO - scLightGAT.preprocess.prediction_preprocess - Transforming AnnData object for Celltype_training
2025-07-22 16:27:20 - INFO - scLightGAT.preprocess.prediction_preprocess - Balancing classes with target count 10000
2025-07-22 16:27:20 - INFO - scLightGAT.preprocess.prediction_preprocess - Original class counts:
encoding
5     36458
7     32291
1     24899
4     12856
6     10649
10     9373
0      6964
2      6274
9      5294
11     4583
3      4470
8      4138
12      432
Name: count, dtype: int64
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._che
ck_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._che
ck_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._che
ck_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._che
ck_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
2025-07-22 16:27:23 - INFO - scLightGAT.preprocess.prediction_preprocess - üîßResampled class counts:
encoding
0     10000
1     10000
2     10000
3     10000
4     10000
5     10000
6     10000
7     10000
8     10000
9     10000
10    10000
11    10000
12    10000
Name: count, dtype: int64
2025-07-22 16:27:23 - INFO - scLightGAT.training.model_manager - Extracting features with DVAE
2025-07-22 16:27:23 - INFO - scLightGAT.models.dvae_model - Initializing DVAE on device: cuda
2025-07-22 16:27:24 - INFO - scLightGAT.models.dvae_model - DVAE initialized with:
2025-07-22 16:27:24 - INFO - scLightGAT.models.dvae_model - Input dimension: 3000
2025-07-22 16:27:24 - INFO - scLightGAT.models.dvae_model - Latent dimension: 300
2025-07-22 16:27:24 - INFO - scLightGAT.models.dvae_model - Cluster weight: 1
2025-07-22 16:27:24 - INFO - scLightGAT.models.dvae_model - Temperature: 0.01
2025-07-22 16:27:24 - INFO - scLightGAT.training.model_manager - DVAE initialized with input_dim: 3000
2025-07-22 16:27:24 - INFO - scLightGAT.training.model_manager - Starting DVAE training with contrastive learning
Epoch 1/5:   0%|
                                                                                | 0/1240 [00:00<?, ?it/s]/Group16T/common/lcy/dslab
_lcy/GitRepo/scLightGAT/scLightGAT/training/model_manager.py:223: FutureWarning: Series.__getitem__ treating keys as positions is d
eprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a val
ue by position, use `ser.iloc[pos]`
  batch_labels = torch.tensor(
Epoch 1/5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1240/1240 [00:22<00:00, 55.97it/s]
Epoch 2/5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1240/1240 [00:23<00:00, 53.70it/s]
Epoch 3/5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1240/1240 [00:22<00:00, 54.62it/s]
Epoch 4/5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1240/1240 [00:23<00:00, 53.26it/s]
Epoch 5/5: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1240/1240 [00:23<00:00, 53.49it/s]
2025-07-22 16:29:18 - INFO - scLightGAT.training.model_manager - Epoch [5/5], Loss: 0.3313, LR: 0.000001
2025-07-22 16:29:19 - INFO - scLightGAT.training.model_manager - DVAE training completed
2025-07-22 16:29:20 - INFO - scLightGAT.training.model_manager - Transforming AnnData for Celltype_training
2025-07-22 16:29:20 - INFO - scLightGAT.training.model_manager - Transforming AnnData for Celltype_training
2025-07-22 16:29:22 - INFO - scLightGAT.preprocess.prediction_preprocess - Balancing classes with target count 10000
2025-07-22 16:29:22 - INFO - scLightGAT.preprocess.prediction_preprocess - Original class counts:
encoding
5     36458
7     32291
1     24899
4     12856
6     10649
10     9373
0      6964
2      6274
9      5294
11     4583
3      4470
8      4138
12      432
Name: count, dtype: int64
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._che
ck_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._che
ck_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:484: FutureWarning: `BaseEstimator._che
ck_n_features` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_n_features` instead.
  warnings.warn(
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/base.py:493: FutureWarning: `BaseEstimator._che
ck_feature_names` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation._check_feature_names` instead.
  warnings.warn(
2025-07-22 16:29:25 - INFO - scLightGAT.preprocess.prediction_preprocess - üîßResampled class counts:
encoding
0     10000
1     10000
2     10000
3     10000
4     10000
5     10000
6     10000
7     10000
8     10000
9     10000
10    10000
11    10000
12    10000
Name: count, dtype: int64
2025-07-22 16:29:25 - INFO - scLightGAT.training.model_manager - Feature extraction completed
2025-07-22 16:29:25 - INFO - scLightGAT.training.model_manager - Starting classification
2025-07-22 16:29:25 - INFO - scLightGAT.training.model_manager - Starting LightGBM training
2025-07-22 16:29:25 - INFO - scLightGAT.models.lightgbm_model - Using default parameters
2025-07-22 16:29:25 - INFO - scLightGAT.models.lightgbm_model - Best parameters: {'max_depth': 10, 'num_leaves': 77, 'learning_rate
': 0.2106, 'n_estimators': 150, 'min_data_in_leaf': 64, 'feature_fraction': 0.7, 'bagging_fraction': 0.7, 'bagging_freq': 5, 'reg_a
lpha': 0.1, 'reg_lambda': 0.1}
2025-07-22 16:29:26 - INFO - scLightGAT.models.lightgbm_model - Training LightGBM model with 91000 samples, 1162 features
2025-07-22 16:30:37 - INFO - scLightGAT.models.lightgbm_model - Test accuracy: 0.9838
2025-07-22 16:30:37 - INFO - scLightGAT.models.lightgbm_model - Classification report:
              precision    recall  f1-score   support

           0       1.00      0.98      0.99      3000
           1       0.98      0.96      0.97      3000
           2       0.95      0.98      0.97      3000
           3       0.96      0.98      0.97      3000
           4       1.00      1.00      1.00      3000
           5       1.00      0.99      1.00      3000
           6       1.00      1.00      1.00      3000
           7       0.97      0.95      0.96      3000
           8       1.00      1.00      1.00      3000
           9       0.96      0.97      0.96      3000
          10       1.00      0.99      1.00      3000
          11       0.99      1.00      0.99      3000
          12       1.00      1.00      1.00      3000

    accuracy                           0.98     39000
   macro avg       0.98      0.98      0.98     39000
weighted avg       0.98      0.98      0.98     39000

2025-07-22 16:30:39 - INFO - scLightGAT.models.lightgbm_model - Confusion matrix saved to lightgbm_confusion_matrix.png
2025-07-22 16:30:39 - INFO - scLightGAT.training.model_manager - LightGBM training completed
2025-07-22 16:30:40 - INFO - scLightGAT.training.model_manager - Classification completed
2025-07-22 16:30:40 - INFO - scLightGAT.training.model_manager - Starting refinement with GAT
2025-07-22 16:30:40 - INFO - scLightGAT.preprocess.preprocess - Starting visualization process
2025-07-22 16:30:40 - INFO - scLightGAT.preprocess.preprocess - Performing PCA (Default components are 50)
2025-07-22 16:30:41 - INFO - scLightGAT.preprocess.preprocess - Computing neighbors
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: The TBB t
hreading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 1205
0. The TBB threading layer is disabled.
  warnings.warn(problem)
2025-07-22 16:31:16 - INFO - scLightGAT.preprocess.preprocess - Computing UMAP
2025-07-22 16:31:56 - INFO - scLightGAT.preprocess.preprocess - Performing Leiden clustering
/Group16T/common/lcy/dslab_lcy/GitRepo/scLightGAT/scLightGAT/preprocess/preprocess.py:103: FutureWarning: In the future, the defaul
t backend for leiden will be igraph instead of leidenalg.

 To achieve the future defaults please pass: flavor="igraph" and n_iterations=2.  directed must also be False to work with igraph's
 implementation.
  sc.tl.leiden(adata, resolution=res)
2025-07-22 16:33:50 - INFO - scLightGAT.preprocess.preprocess - Merging 1 small clusters
2025-07-22 16:33:50 - INFO - scLightGAT.preprocess.preprocess - ‚úÖVisualization process completed
2025-07-22 16:33:50 - INFO - scLightGAT.training.model_manager - Preparing data for GAT
2025-07-22 16:34:01 - INFO - scLightGAT.training.model_manager - GAT model initialized with 878 in_channels and 13 out_channels
2025-07-22 16:34:01 - INFO - scLightGAT.training.model_manager - Starting GAT training
Training GAT:   3%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè
                                                            | 9/300 [00:03<01:27,  3.34it/s, loss=1.1553]2025-07-22 16:34:04 - INFO
 - scLightGAT.models.gat_model - Epoch [10/300], Loss: 1.1553
Training GAT:   6%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä
                                                           | 19/300 [00:06<01:26,  3.23it/s, loss=0.9239]2025-07-22 16:34:07 - INFO
 - scLightGAT.models.gat_model - Epoch [20/300], Loss: 0.9239
Training GAT:  10%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå
                                                           | 29/300 [00:09<01:28,  3.07it/s, loss=0.8219]2025-07-22 16:34:11 - INFO
 - scLightGAT.models.gat_model - Epoch [30/300], Loss: 0.8219
Training GAT:  13%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè
                                                           | 39/300 [00:12<01:29,  2.91it/s, loss=0.7590]2025-07-22 16:34:14 - INFO
 - scLightGAT.models.gat_model - Epoch [40/300], Loss: 0.7590
Training GAT:  16%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ
                                                           | 49/300 [00:15<01:13,  3.41it/s, loss=0.7213]2025-07-22 16:34:17 - INFO
 - scLightGAT.models.gat_model - Epoch [50/300], Loss: 0.7213
Training GAT:  20%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã
                                                           | 59/300 [00:18<01:20,  2.98it/s, loss=0.6957]2025-07-22 16:34:20 - INFO
 - scLightGAT.models.gat_model - Epoch [60/300], Loss: 0.6957
Training GAT:  23%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé
                                                           | 69/300 [00:21<01:10,  3.29it/s, loss=0.6748]2025-07-22 16:34:23 - INFO
 - scLightGAT.models.gat_model - Epoch [70/300], Loss: 0.6748
Training GAT:  26%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
                                                           | 79/300 [00:24<01:08,  3.24it/s, loss=0.6569]2025-07-22 16:34:26 - INFO
 - scLightGAT.models.gat_model - Epoch [80/300], Loss: 0.6569
Training GAT:  30%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã
                                                           | 89/300 [00:27<01:02,  3.38it/s, loss=0.6440]2025-07-22 16:34:29 - INFO
 - scLightGAT.models.gat_model - Epoch [90/300], Loss: 0.6440
Training GAT:  33%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç
                                                           | 99/300 [00:30<00:59,  3.35it/s, loss=0.6314]2025-07-22 16:34:32 - INFO
 - scLightGAT.models.gat_model - Epoch [100/300], Loss: 0.6314
Training GAT:  36%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä
                                                          | 109/300 [00:33<00:57,  3.32it/s, loss=0.6172]2025-07-22 16:34:35 - INFO
 - scLightGAT.models.gat_model - Epoch [110/300], Loss: 0.6172
Training GAT:  40%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç
                                                          | 119/300 [00:36<00:54,  3.33it/s, loss=0.6090]2025-07-22 16:34:38 - INFO
 - scLightGAT.models.gat_model - Epoch [120/300], Loss: 0.6090
Training GAT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
                                                          | 129/300 [00:39<00:51,  3.29it/s, loss=0.5997]2025-07-22 16:34:41 - INFO
 - scLightGAT.models.gat_model - Epoch [130/300], Loss: 0.5997
Training GAT:  46%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä
                                                          | 139/300 [00:42<00:48,  3.33it/s, loss=0.5911]2025-07-22 16:34:44 - INFO
 - scLightGAT.models.gat_model - Epoch [140/300], Loss: 0.5911
Training GAT:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç
                                                          | 149/300 [00:45<00:45,  3.33it/s, loss=0.5824]2025-07-22 16:34:47 - INFO
 - scLightGAT.models.gat_model - Epoch [150/300], Loss: 0.5824
Training GAT:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
                                                          | 159/300 [00:48<00:42,  3.32it/s, loss=0.5730]2025-07-22 16:34:50 - INFO
 - scLightGAT.models.gat_model - Epoch [160/300], Loss: 0.5730
Training GAT:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä
                                                          | 169/300 [00:51<00:39,  3.32it/s, loss=0.5678]2025-07-22 16:34:53 - INFO
 - scLightGAT.models.gat_model - Epoch [170/300], Loss: 0.5678
Training GAT:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç
                                                          | 179/300 [00:54<00:36,  3.31it/s, loss=0.5620]2025-07-22 16:34:56 - INFO
 - scLightGAT.models.gat_model - Epoch [180/300], Loss: 0.5620
Training GAT:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
                                                          | 189/300 [00:57<00:33,  3.30it/s, loss=0.5537]2025-07-22 16:34:59 - INFO
 - scLightGAT.models.gat_model - Epoch [190/300], Loss: 0.5537
Training GAT:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñä                                                         | 199/300 [01:00<00:30,  3.30it/s, loss=0.5500]2025-07-22 16:35:02 - INFO
 - scLightGAT.models.gat_model - Epoch [200/300], Loss: 0.5500
Training GAT:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç                                                   | 209/300 [01:03<00:27,  3.36it/s, loss=0.5455]2025-07-22 16:35:05 - INFO
 - scLightGAT.models.gat_model - Epoch [210/300], Loss: 0.5455
Training GAT:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                              | 219/300 [01:06<00:24,  3.31it/s, loss=0.5387]2025-07-22 16:35:08 - INFO
 - scLightGAT.models.gat_model - Epoch [220/300], Loss: 0.5387
Training GAT:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä                                        | 229/300 [01:09<00:21,  3.30it/s, loss=0.5338]2025-07-22 16:35:11 - INFO
 - scLightGAT.models.gat_model - Epoch [230/300], Loss: 0.5338
Training GAT:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç                                  | 239/300 [01:12<00:18,  3.30it/s, loss=0.5298]2025-07-22 16:35:14 - INFO
 - scLightGAT.models.gat_model - Epoch [240/300], Loss: 0.5298
Training GAT:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                             | 249/300 [01:16<00:15,  3.29it/s, loss=0.5238]2025-07-22 16:35:17 - INFO
 - scLightGAT.models.gat_model - Epoch [250/300], Loss: 0.5238
Training GAT:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä                       | 259/300 [01:19<00:12,  3.30it/s, loss=0.5217]2025-07-22 16:35:20 - INFO
 - scLightGAT.models.gat_model - Epoch [260/300], Loss: 0.5217
Training GAT:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç                 | 269/300 [01:22<00:09,  3.30it/s, loss=0.5168]2025-07-22 16:35:23 - INFO
 - scLightGAT.models.gat_model - Epoch [270/300], Loss: 0.5168
Training GAT:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà            | 279/300 [01:25<00:06,  3.28it/s, loss=0.5107]2025-07-22 16:35:26 - INFO
 - scLightGAT.models.gat_model - Epoch [280/300], Loss: 0.5107
Training GAT:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä      | 289/300 [01:28<00:03,  3.28it/s, loss=0.5065]2025-07-22 16:35:29 - INFO
 - scLightGAT.models.gat_model - Epoch [290/300], Loss: 0.5065
Training GAT: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 299/300 [01:31<00:00,  3.28it/s, loss=0.5020]2025-07-22 16:35:32 - INFO
 - scLightGAT.models.gat_model - Epoch [300/300], Loss: 0.5020
Training GAT: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 300/300 [01:31<00:00,  3.29it/s, loss=0.5020]
2025-07-22 16:35:32 - INFO - scLightGAT.training.model_manager - GAT training completed
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to contr
ol this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this
behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter t
o control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to contr
ol this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this
behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter t
o control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to contr
ol this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this
behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Group16T/common/lcy/miniconda3/envs/scLightGAT/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetri
cWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter t
o control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-07-22 16:35:32 - INFO - scLightGAT.models.gat_model - Accuracy: 0.8274
2025-07-22 16:35:32 - INFO - scLightGAT.models.gat_model - Classification Report:
2025-07-22 16:35:32 - INFO - scLightGAT.models.gat_model -                    precision    recall  f1-score   support

          B cells       0.61      0.91      0.73      1545
      CD4+T cells       0.77      0.68      0.73     13463
      CD8+T cells       0.00      0.00      0.00        50
               DC       0.71      0.93      0.81       404
Endothelial cells       0.65      0.32      0.43        96
 Epithelial cells       0.69      0.66      0.68      1387
      Fibroblasts       0.00      0.00      0.00         0
      Macrophages       0.69      0.44      0.54       792
       Mast cells       0.80      0.51      0.62      7695
        Monocytes       0.63      0.77      0.70       502
         NK cells       0.86      0.94      0.90     42345
     Plasma cells       0.78      0.62      0.69       240
              pDC       0.76      0.62      0.68        60

         accuracy                           0.83     68579
        macro avg       0.61      0.57      0.58     68579
     weighted avg       0.82      0.83      0.82     68579

2025-07-22 16:35:32 - INFO - scLightGAT.training.model_manager - Refinement completed with accuracy: 0.8274
2025-07-22 16:35:32 - INFO - scLightGAT.training.model_manager - Creating UMAP visualization for cell type predictions
WARNING: saving figure to file umap_scLightGAT.png
2025-07-22 16:35:34 - INFO - scLightGAT.visualization.visualization - Creating training loss plot for GAT
2025-07-22 16:35:35 - INFO - scLightGAT.training.model_manager - Annotation pipeline completed
2025-07-22 16:35:40 - INFO - scLightGAT.pipeline - [TRAIN MODE] Training pipeline completed
dslab_lcy@chenh2-tyna:/Group16T/common/lcy/dslab_lcy/GitRepo/scLightGAT$ tmux capture-pane -pS -500 > log_pbmcFix.txt

